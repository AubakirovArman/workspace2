# üé≠ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - –ì–æ–≤–æ—Ä—è—â–∏–π –ê–≤–∞—Ç–∞—Ä

## –ß—Ç–æ —ç—Ç–æ?

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤ –≤–∏–¥–µ–æ —Å –≥–æ–≤–æ—Ä—è—â–∏–º –∞–≤–∞—Ç–∞—Ä–æ–º:
1. ‚úçÔ∏è –í–≤–æ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç
2. üé§ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–∑–≤—É—á–∫–∞ (TTS)
3. üé¨ –°–æ–∑–¥–∞–µ—Ç—Å—è –≤–∏–¥–µ–æ —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –≥—É–± (Wav2Lip)
4. üì∫ –°–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ!

## üöÄ –ó–∞–ø—É—Å–∫ (3 –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞)

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
/workspace/avatar.jpg           ‚Üê –§–æ—Ç–æ –∞–≤–∞—Ç–∞—Ä–∞
/workspace/Wav2Lip-SD-GAN.pt   ‚Üê –ú–æ–¥–µ–ª—å Wav2Lip
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–æ–¥–∏–Ω —Ä–∞–∑):
```bash
cd /workspace
pip install -r requirements_web.txt
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
```bash
python app.py
```

**–ò–õ–ò –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:**
```bash
./start_web.sh
```

## üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: **http://localhost:3000**

2. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
   - üñºÔ∏è –í–∞—à –∞–≤–∞—Ç–∞—Ä
   - ‚úçÔ∏è –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
   - üåç –í—ã–±–æ—Ä —è–∑—ã–∫–∞ (–†—É—Å—Å–∫–∏–π/–ö–∞–∑–∞—Ö—Å–∫–∏–π/–ê–Ω–≥–ª–∏–π—Å–∫–∏–π)
   - üé§ –ö–Ω–æ–ø–∫–∞ "–û–∑–≤—É—á–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ"

3. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä: `–ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–≤–∞—Ç–∞—Ä, –∏ —è –º–æ–≥—É –≥–æ–≤–æ—Ä–∏—Ç—å.`

4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üé§ –û–∑–≤—É—á–∏—Ç—å"

5. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 15-30 —Å–µ–∫—É–Ω–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç CPU/GPU)

6. –í–∏–¥–µ–æ –ø–æ—è–≤–∏—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ - –º–æ–∂–µ—Ç–µ —Å–º–æ—Ç—Ä–µ—Ç—å –∏–ª–∏ —Å–∫–∞—á–∞—Ç—å!

## ‚ö° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: ~10-15 —Å–µ–∫—É–Ω–¥ (–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π)
- **–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã**: ~15-30 —Å–µ–∫—É–Ω–¥ (–º–æ–¥–µ–ª–∏ —É–∂–µ –≤ –ø–∞–º—è—Ç–∏!)
- **–° GPU**: –í 3-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!

### –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞
‚úÖ –ú–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
‚úÖ –ê–≤–∞—Ç–∞—Ä –¥–µ—Ä–∂–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
‚úÖ Face detection –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É!

### –ß–µ—Ä–µ–∑ API (curl)
```bash
curl -X POST http://localhost:3000/api/generate \
  -H "Content-Type: application/json" \
  -d '{"text": "–ü—Ä–∏–≤–µ—Ç –º–∏—Ä!", "language": "ru"}' \
  --output video.mp4
```

### –ß–µ—Ä–µ–∑ API (Python)
```python
import requests

response = requests.post(
    'http://localhost:3000/api/generate',
    json={'text': '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!', 'language': 'ru'}
)

with open('result.mp4', 'wb') as f:
    f.write(response.content)
```

## üìä API Endpoints

| Endpoint | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| `/` | GET | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| `/api/health` | GET | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ |
| `/api/generate` | POST | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ |
| `/api/avatar` | GET | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ |

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
–ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª `/workspace/avatar.jpg` –Ω–∞ —Å–≤–æ–π

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é –º–æ–¥–µ–ª—å
–í `app.py` –∏–∑–º–µ–Ω–∏—Ç–µ:
```python
CHECKPOINT_PATH = '/workspace/Wav2Lip-SD-NOGAN.pt'  # –ë—ã—Å—Ç—Ä–µ–µ, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∏–∂–µ
```

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç
–í –∫–æ–Ω—Ü–µ `app.py`:
```python
app.run(port=8080)  # –í–º–µ—Å—Ç–æ 3000
```

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ö–∞–∫ —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É?**
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU! –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 3-5 —Ä–∞–∑. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `python -c "import torch; print(torch.cuda.is_available())"`

**Q: –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 3000 —Å–≤–æ–±–æ–¥–µ–Ω: `lsof -i :3000`

**Q: –û—à–∏–±–∫–∞ "Face not detected"**
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ—Ç–∫–æ–µ —Ñ–æ—Ç–æ –ª–∏—Ü–∞ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ, —Å —Ö–æ—Ä–æ—à–∏–º –æ—Å–≤–µ—â–µ–Ω–∏–µ–º

**Q: TTS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (TTS API —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ https://tts.sk-ai.kz)

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ù–µ—Ç GPU
```bash
# –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ CPU
# –†–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ
```

### Out of Memory
```python
# –í app.py —É–º–µ–Ω—å—à–∏—Ç–µ batch_size:
lipsync_service = LipsyncService(
    ...
    face_det_batch_size=8,   # –±—ã–ª–æ 16
    wav2lip_batch_size=64    # –±—ã–ª–æ 128
)
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv
source venv/bin/activate
pip install -r requirements_web.txt
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
/workspace/
‚îú‚îÄ‚îÄ app.py                  ‚Üê –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ index.html          ‚Üê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ avatar.jpg              ‚Üê –í–∞—à –∞–≤–∞—Ç–∞—Ä
‚îú‚îÄ‚îÄ Wav2Lip-SD-GAN.pt       ‚Üê –ú–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ outputs/                ‚Üê –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ
‚îú‚îÄ‚îÄ temp_web/               ‚Üê –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îî‚îÄ‚îÄ modern-lipsync/         ‚Üê –ú–æ–¥—É–ª–∏ Wav2Lip
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ–≤–æ—Ä—è—â–∏—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤!

**–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å–≤–æ–∏—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ-–∞–≤–∞—Ç–∞—Ä–æ–≤
- –í—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞ TTS
- –ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ lip-sync

---

**–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è! üöÄ**
